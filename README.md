# ML-DL
### в своем приложении я использую стандартную модель ssd300 от mmdetection + efficientnet_b0 для дополнительной классификации изображений

Для классификации изображений в файле mmdet.core.visualization.image я добавила код, 
который при условии что обнаруженный объект имеет класс "0" - человек
происходит кроп по баундинг боксу детектированного человека 
и вырезанная картинка отправляется на классификацию модели yoga_poses_classificator_model.pkl
модель натрннированная на датасете по классификации картинок для йоги (из Кагл) - основа модели Eficcitntnrt_b0


Функция визуализации show_result_pyplot из mmdetection печатает результат, но ничего не возвращает
по этому я ввела дополнительную функцию  my_output_for_gr() которая возвращает значение numpy.array
для визуализации использовала средства gradio на huggingface
https://huggingface.co/spaces/danilovabg/detection_project


Так как файл image.py подвергся модификации - добавляю его в папку с другими файлами приложния


в файле image.py произведены изменения
1. добавлена фунция predict для предсказания позы человека (строки 225-235)

2. подгружается тренированная модель efficientnet_b0 (стр 237)

3. добавлена функция classify_yoga_pose для классификации йога позы (строки 239-263)

4. лейблы для классов йога поз  107 классов (стр 265 - 300)

5. в функцию imshow_det_bboxes добавлен код для кропа и дополнительной классификации детектированного объекта (стр 273 - 384)

6. изменена функция draw_labels, в ней изменен текст лейблов (стр 146-161)

7. добавлена глобальная переменная которой в функции imshow_det_bboxes присваивается значение глобальной переменной - финальный вид каринки со всеми боксами и лейблами

8. добавлена функция my_output_for_gr возвращающая картинку необходимую для визуализации в приложении
